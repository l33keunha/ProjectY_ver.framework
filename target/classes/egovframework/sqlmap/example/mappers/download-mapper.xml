<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ybs.indicator.download.service.impl.DownloadMapper">

	<!-- 컬럼갯수가져오기 -->
	<select id ="selectdownloadResultListColumnCnt" parameterType="String" resultType="int">
		select COUNT(column_name) CNT from user_tab_columns where table_name = upper(#{tableNm})
	</select>
	
	<!-- 컬럼가져오기 -->
	<select id ="selectdownloadResultListColumn" parameterType="String" resultType="egovMap">
		select column_name from user_tab_columns where table_name = upper(#{tableNm})
		ORDER BY COLUMN_ID
	</select>
	
	<!-- 정류장간OD 목적통행 -->
	<select id ="selectdownloadResultListStationOD_purpose" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT /*+ PARALLEL(4) */
			분석지역_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN OWNER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,운행일자
			,승차내외부
			,승차역ID
			,승차지역명
			,하차내외부
			,하차역ID
			,하차지역명
			,시간
			,일반
			,어린이
			,청소년
			,경로
			,장애인
			,국가유공자
			,다자녀부모
			,동반
			,대학생
			,복지
			,기타
		FROM PIVOT_정류장별OD_목적통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
		ORDER BY 승차내외부, 승차역ID, 하차내외부, 하차역ID, 시간
	</select>
	
	<!-- 정류장간OD 수단통행 -->
	<select id ="selectdownloadResultListStationOD_method" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT /*+ PARALLEL(4) */
			분석지역_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN OWNER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,운행일자
			,승차내외부
			,승차역ID
			,승차지역명
			,하차내외부
			,하차역ID
			,하차지역명
			,시간
			,일반
			,어린이
			,청소년
			,경로
			,장애인
			,국가유공자
			,다자녀부모
			,동반
			,대학생
			,복지
			,기타
		FROM PIVOT_정류장별OD_수단통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
		ORDER BY 승차내외부, 승차역ID, 하차내외부, 하차역ID, 시간
	</select>
	
	<!-- 노선별 정류장간OD -->
	<select id ="selectdownloadResultListRouteOD" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT  /*+ PARALLEL(4) */
			ANAL_AREA_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN PROVIDER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,OPRAT_DATE
			,TFCMN
			,ROUTE_ID
			,ROUTE_NMA
			,ROUTE_TYPE
			,ROUTE_START
			,ROUTE_END
			,출발정류장순번
			,출발정류장ID
			,출발정류장명
			,출발정류장행정동
			,도착정류장순번
			,도착정류장ID
			,도착정류장명
			,도착정류장행정동
			,TM
			,일반
			,어린이
			,청소년
			,경로
			,장애인
			,국가유공자
			,다자녀부모
			,동반
			,대학생
			,복지
			,기타
		FROM PIVOT_노선별OD
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
		ORDER BY ROUTE_ID, 출발정류장순번, 도착정류장순번, TM
	</select>
	
	<!-- 행정동간OD 목적통행 -->
	<select id ="selectdownloadResultListAreaOD_purpose" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			분석지역_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN OWNER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,운행일자
			,승차내외부
			,승차지역코드
			,승차지역명
			,하차내외부
			,하차지역코드
			,하차지역명
			,STIME
			,일반
			,어린이
			,청소년
			,경로
			,장애인
			,국가유공자
			,다자녀부모
			,동반
			,대학생
			,복지
			,기타
		FROM PIVOT_행정동별OD_목적통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
		ORDER BY 승차내외부, 승차지역코드, 하차내외부, 하차지역코드, STIME
	</select>
	
	<!-- 행정동간OD 수단통행 -->
	<select id ="selectdownloadResultListAreaOD_method" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			분석지역_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN OWNER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,운행일자
			,승차내외부
			,승차지역코드
			,승차지역명
			,하차내외부
			,하차지역코드
			,하차지역명
			,STIME
			,일반
			,어린이
			,청소년
			,경로
			,장애인
			,국가유공자
			,다자녀부모
			,동반
			,대학생
			,복지
			,기타
		FROM PIVOT_행정동별OD_수단통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
		ORDER BY 승차내외부, 승차지역코드, 하차내외부, 하차지역코드, STIME
	</select>
	
	<!-- 정류장별통행 버스 -->
	<select id ="selectdownloadResultListStationCntB" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			ANAL_AREA_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN PROVIDER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,OPRAT_DATE
			,TFCMN
			,STTN_ID
			,STTN_NMA
			,STTN_HJD
			,TM
			,일반_STTN_BUS_GIN_AGG
			,일반_STTN_BUS_GFF_AGG
			,일반_STTN_BUS_TRS_AGG
			,어린이_STTN_BUS_GIN_AGG
			,어린이_STTN_BUS_GFF_AGG
			,어린이_STTN_BUS_TRS_AGG
			,청소년_STTN_BUS_GIN_AGG
			,청소년_STTN_BUS_GFF_AGG
			,청소년_STTN_BUS_TRS_AGG
			,경로_STTN_BUS_GIN_AGG
			,경로_STTN_BUS_GFF_AGG
			,경로_STTN_BUS_TRS_AGG
			,장애인_STTN_BUS_GIN_AGG
			,장애인_STTN_BUS_GFF_AGG
			,장애인_STTN_BUS_TRS_AGG
			,국가유공자_STTN_BUS_GIN_AGG
			,국가유공자_STTN_BUS_GFF_AGG
			,국가유공자_STTN_BUS_TRS_AGG
			,다자녀부모_STTN_BUS_GIN_AGG
			,다자녀부모_STTN_BUS_GFF_AGG
			,다자녀부모_STTN_BUS_TRS_AGG
			,동반_STTN_BUS_GIN_AGG
			,동반_STTN_BUS_GFF_AGG
			,동반_STTN_BUS_TRS_AGG
			,대학생_STTN_BUS_GIN_AGG
			,대학생_STTN_BUS_GFF_AGG
			,대학생_STTN_BUS_TRS_AGG
			,복지_STTN_BUS_GIN_AGG
			,복지_STTN_BUS_GFF_AGG
			,복지_STTN_BUS_TRS_AGG
			,기타_STTN_BUS_GIN_AGG
			,기타_STTN_BUS_GFF_AGG
			,기타_STTN_BUS_TRS_AGG
		FROM PIVOT_정류장별통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
			AND TFCMN = 'B'
		ORDER BY STTN_ID, TM
	</select>
	
	<!-- 정류장별통행 지하철 -->
	<select id ="selectdownloadResultListStationCntT" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			ANAL_AREA_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN PROVIDER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,OPRAT_DATE
			,TFCMN
			,STTN_ID
			,STTN_NMA
			,STTN_HJD
			,TM
			,일반_STTN_TRAIN_GIN_AGG
			,일반_STTN_TRAIN_GFF_AGG
			,일반_STTN_TRAIN_TRS_AGG
			,어린이_STTN_TRAIN_GIN_AGG
			,어린이_STTN_TRAIN_GFF_AGG
			,어린이_STTN_TRAIN_TRS_AGG
			,청소년_STTN_TRAIN_GIN_AGG
			,청소년_STTN_TRAIN_GFF_AGG
			,청소년_STTN_TRAIN_TRS_AGG
			,경로_STTN_TRAIN_GIN_AGG
			,경로_STTN_TRAIN_GFF_AGG
			,경로_STTN_TRAIN_TRS_AGG
			,장애인_STTN_TRAIN_GIN_AGG
			,장애인_STTN_TRAIN_GFF_AGG
			,장애인_STTN_TRAIN_TRS_AGG
			,국가유공자_STTN_TRAIN_GIN_AGG
			,국가유공자_STTN_TRAIN_GFF_AGG
			,국가유공자_STTN_TRAIN_TRS_AGG
			,다자녀부모_STTN_TRAIN_GIN_AGG
			,다자녀부모_STTN_TRAIN_GFF_AGG
			,다자녀부모_STTN_TRAIN_TRS_AGG
			,동반_STTN_TRAIN_GIN_AGG
			,동반_STTN_TRAIN_GFF_AGG
			,동반_STTN_TRAIN_TRS_AGG
			,대학생_STTN_TRAIN_GIN_AGG
			,대학생_STTN_TRAIN_GFF_AGG
			,대학생_STTN_TRAIN_TRS_AGG
			,복지_STTN_TRAIN_GIN_AGG
			,복지_STTN_TRAIN_GFF_AGG
			,복지_STTN_TRAIN_TRS_AGG
			,기타_STTN_TRAIN_GIN_AGG
			,기타_STTN_TRAIN_GFF_AGG
			,기타_STTN_TRAIN_TRS_AGG
		FROM PIVOT_정류장별통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
			AND TFCMN = 'T'
		ORDER BY STTN_ID, TM
	</select>
	
	<!-- 노선별통행 버스 -->
	<select id ="selectdownloadResultListRouteCntB" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			ANAL_AREA_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN PROVIDER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,OPRAT_DATE
			,TFCMN
			,ROUTE_ID 
			,ROUTE_NMA 
			,ROUTE_TYPE 
			,ROUTE_START 
			,ROUTE_END 
			,TM
			,일반_ROUTE_BUS_GIN_AGG
			,일반_ROUTE_BUS_GFF_AGG
			,일반_ROUTE_BUS_TRS_AGG
			,어린이_ROUTE_BUS_GIN_AGG
			,어린이_ROUTE_BUS_GFF_AGG
			,어린이_ROUTE_BUS_TRS_AGG
			,청소년_ROUTE_BUS_GIN_AGG
			,청소년_ROUTE_BUS_GFF_AGG
			,청소년_ROUTE_BUS_TRS_AGG
			,경로_ROUTE_BUS_GIN_AGG
			,경로_ROUTE_BUS_GFF_AGG
			,경로_ROUTE_BUS_TRS_AGG
			,장애인_ROUTE_BUS_GIN_AGG
			,장애인_ROUTE_BUS_GFF_AGG
			,장애인_ROUTE_BUS_TRS_AGG
			,국가유공자_ROUTE_BUS_GIN_AGG
			,국가유공자_ROUTE_BUS_GFF_AGG
			,국가유공자_ROUTE_BUS_TRS_AGG
			,다자녀부모_ROUTE_BUS_GIN_AGG
			,다자녀부모_ROUTE_BUS_GFF_AGG
			,다자녀부모_ROUTE_BUS_TRS_AGG
			,동반_ROUTE_BUS_GIN_AGG
			,동반_ROUTE_BUS_GFF_AGG
			,동반_ROUTE_BUS_TRS_AGG
			,대학생_ROUTE_BUS_GIN_AGG
			,대학생_ROUTE_BUS_GFF_AGG
			,대학생_ROUTE_BUS_TRS_AGG
			,복지_ROUTE_BUS_GIN_AGG
			,복지_ROUTE_BUS_GFF_AGG
			,복지_ROUTE_BUS_TRS_AGG
			,기타_ROUTE_BUS_GIN_AGG
			,기타_ROUTE_BUS_GFF_AGG
			,기타_ROUTE_BUS_TRS_AGG
		FROM PIVOT_노선별통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
			AND TFCMN = 'B'
		ORDER BY ROUTE_ID, ROUTE_NMA, TM
	</select>
	
	<!-- 노선별통행 지하철 -->
	<select id ="selectdownloadResultListRouteCntT" parameterType="sVO" resultType="egovMap" fetchSize="2000">
		SELECT 
			ANAL_AREA_CD
			,#{anal_area_cd_sido_text} ANAL_AREA_SIDO_CD_TEXT
			,#{anal_area_cd_text} ANAL_AREA_CD_TEXT
			,CASE WHEN PROVIDER = '00' THEN '국토부' ELSE '정산사' END PROVIDER
			,OPRAT_DATE
			,TFCMN
			,ROUTE_ID 
			,ROUTE_NMA 
			,ROUTE_TYPE 
			,ROUTE_START 
			,ROUTE_END 
			,TM
			,일반_ROUTE_TRAIN_GIN_AGG
			,일반_ROUTE_TRAIN_GFF_AGG
			,일반_ROUTE_TRAIN_TRS_AGG
			,어린이_ROUTE_TRAIN_GIN_AGG
			,어린이_ROUTE_TRAIN_GFF_AGG
			,어린이_ROUTE_TRAIN_TRS_AGG
			,청소년_ROUTE_TRAIN_GIN_AGG
			,청소년_ROUTE_TRAIN_GFF_AGG
			,청소년_ROUTE_TRAIN_TRS_AGG
			,경로_ROUTE_TRAIN_GIN_AGG
			,경로_ROUTE_TRAIN_GFF_AGG
			,경로_ROUTE_TRAIN_TRS_AGG
			,장애인_ROUTE_TRAIN_GIN_AGG
			,장애인_ROUTE_TRAIN_GFF_AGG
			,장애인_ROUTE_TRAIN_TRS_AGG
			,국가유공자_ROUTE_TRAIN_GIN_AGG
			,국가유공자_ROUTE_TRAIN_GFF_AGG
			,국가유공자_ROUTE_TRAIN_TRS_AGG
			,다자녀부모_ROUTE_TRAIN_GIN_AGG
			,다자녀부모_ROUTE_TRAIN_GFF_AGG
			,다자녀부모_ROUTE_TRAIN_TRS_AGG
			,동반_ROUTE_TRAIN_GIN_AGG
			,동반_ROUTE_TRAIN_GFF_AGG
			,동반_ROUTE_TRAIN_TRS_AGG
			,대학생_ROUTE_TRAIN_GIN_AGG
			,대학생_ROUTE_TRAIN_GFF_AGG
			,대학생_ROUTE_TRAIN_TRS_AGG
			,복지_ROUTE_TRAIN_GIN_AGG
			,복지_ROUTE_TRAIN_GFF_AGG
			,복지_ROUTE_TRAIN_TRS_AGG
			,기타_ROUTE_TRAIN_GIN_AGG
			,기타_ROUTE_TRAIN_GFF_AGG
			,기타_ROUTE_TRAIN_TRS_AGG
		FROM PIVOT_노선별통행
		WHERE 1=1
			AND SDATE = TO_DATE(#{dateStart} , 'YYYY-MM-DD')
			AND PART_KEY = #{provider} || '_' || #{anal_area_cd}
			AND TFCMN = 'T'
		ORDER BY ROUTE_ID, ROUTE_NMA, TM
	</select>
</mapper>