<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ybs.indicator.pass.service.impl.PassMapper">
	
	<select id ="selectPassSearchAjaxOwner" parameterType="sVO" resultType="egovMap">
	SELECT DISTINCT OWNER FROM 분석지역_CD 
	WHERE 1=1
		AND 운행일자 BETWEEN #{dateStart} AND #{dateEnd}
		<![CDATA[
		AND #{dateStart} >= 운행일자
		AND #{dateEnd} <= 유효일자
		]]>
	ORDER BY OWNER
	</select>
	<select id ="selectPassSearchAjaxSido" parameterType="sVO" resultType="egovMap">
	SELECT DISTINCT 분석지역_CD, 분석지역명 FROM 분석지역_CD 
	WHERE 1=1
		AND 운행일자 BETWEEN #{dateStart} AND #{dateEnd}
		<![CDATA[
		AND #{dateStart} >= 운행일자
		AND #{dateEnd} <= 유효일자
		]]>
		AND OWNER = #{provider}
		AND 분석지역_CD LIKE '__'
	ORDER BY 분석지역_CD
	</select>
	<select id ="selectPassSearchAjaxSigungu" parameterType="sVO" resultType="egovMap">
	SELECT DISTINCT 분석지역_CD, 분석지역명 FROM 분석지역_CD 
	WHERE 1=1
		AND 운행일자 BETWEEN #{dateStart} AND #{dateEnd}
		<![CDATA[
		AND #{dateStart} >= 운행일자
		AND #{dateEnd} <= 유효일자
		]]>
		AND OWNER = #{provider}
		AND 분석지역_CD LIKE #{anal_area_cd} || '%'
	ORDER BY 분석지역명
	</select>
	
	<select id ="selectPassResultListPurpose" parameterType="sVO" resultType="egovMap">
	SELECT /*+ PARALLEL(8) */ ROWNUM, OPRAT_DATE ,ANAL_AREA_CD ,TM ,CD_NO ,USER_CNT_AGG
	FROM
		(SELECT OPRAT_DATE ,ANAL_AREA_CD ,TM ,CD_NO ,USER_CNT_AGG 
		FROM 결과지표_목적통행
			WHERE 1=1
				AND SDATE BETWEEN #{dateStart} AND #{dateEnd}
				AND PROVIDER = #{provider}
				AND ANAL_AREA_CD = #{anal_area_cd}
				<if test="tm==null">
					AND TM BETWEEN #{tmStart} AND #{tmEnd}
				</if>
				<if test="!cd_no[0].equals('00')">
					AND CD_NO IN
					<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
						#{arr}
					</foreach>
				</if>
			ORDER BY OPRAT_DATE, TM, CD_NO)
	ORDER BY ROWNUM
	</select>
	
	<select id ="selectPassResultListMethod" parameterType="sVO" resultType="egovMap">
	SELECT ROWNUM, OPRAT_DATE ,ANAL_AREA_CD ,TM ,CD_NO, TFCMN, USER_CNT_AGG
	FROM
		(SELECT OPRAT_DATE ,ANAL_AREA_CD ,TM ,CD_NO, TFCMN, USER_CNT_AGG 
		FROM 결과지표_수단통행
		WHERE 1=1
			AND SDATE BETWEEN #{dateStart} AND #{dateEnd}
			AND PROVIDER = #{provider}
			AND ANAL_AREA_CD = #{anal_area_cd}
			<if test="tm==null">
				AND TM BETWEEN #{tmStart} AND #{tmEnd}
			</if>
			<if test="!cd_no[0].equals('00')">
				AND CD_NO IN
				<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
					#{arr}
				</foreach>
			</if>
		ORDER BY OPRAT_DATE, TM, CD_NO, TFCMN)
	ORDER BY ROWNUM
	</select>
	

	<select id ="selectPassResultListRouteB" parameterType="sVO" resultType="egovMap">
	SELECT ROWNUM, OPRAT_DATE, ANAL_AREA_CD, TFCMN, ROUTE_NMA, ROUTE_TYPE, ROUTE_START, ROUTE_END, TM, CD_NO, ROUTE_BUS_GIN_AGG, ROUTE_BUS_GFF_AGG, ROUTE_BUS_TRS_AGG
	FROM
		(SELECT OPRAT_DATE, ANAL_AREA_CD, TFCMN, ROUTE_NMA, ROUTE_TYPE, ROUTE_START, ROUTE_END, TM, CD_NO, ROUTE_BUS_GIN_AGG, ROUTE_BUS_GFF_AGG, ROUTE_BUS_TRS_AGG
		FROM 결과지표_노선별통행
		WHERE 1=1
			AND SDATE BETWEEN #{dateStart} AND #{dateEnd}
			AND PROVIDER = #{provider}
			AND ANAL_AREA_CD = #{anal_area_cd}
			<if test="tm==null">
				AND TM BETWEEN #{tmStart} AND #{tmEnd}
			</if>
			<if test="!cd_no[0].equals('00')">
				AND CD_NO IN
				<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
					#{arr}
				</foreach>
			</if>
			AND TFCMN ='B'
		ORDER BY OPRAT_DATE, ROUTE_ID, TM, CD_NO)
	ORDER BY ROWNUM
	</select>
	
	<select id ="selectPassResultListRouteT" parameterType="sVO" resultType="egovMap">
	SELECT ROWNUM, OPRAT_DATE, ANAL_AREA_CD, TFCMN, ROUTE_NMA, ROUTE_TYPE, ROUTE_START, ROUTE_END, TM, CD_NO, ROUTE_TRAIN_GIN_AGG, ROUTE_TRAIN_GFF_AGG, ROUTE_TRAIN_TRS_AGG
	FROM
		(SELECT OPRAT_DATE, ANAL_AREA_CD, TFCMN, ROUTE_NMA, ROUTE_TYPE, ROUTE_START, ROUTE_END, TM, CD_NO, ROUTE_TRAIN_GIN_AGG, ROUTE_TRAIN_GFF_AGG, ROUTE_TRAIN_TRS_AGG
		FROM 결과지표_노선별통행
		WHERE 1=1
			AND SDATE BETWEEN #{dateStart} AND #{dateEnd}
			AND PROVIDER = #{provider}
			AND ANAL_AREA_CD = #{anal_area_cd}
			<if test="tm==null">
				AND TM BETWEEN #{tmStart} AND #{tmEnd}
			</if>
			<if test="!cd_no[0].equals('00')">
				AND CD_NO IN
				<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
					#{arr}
				</foreach>
			</if>
			AND TFCMN ='T'
		ORDER BY OPRAT_DATE, ROUTE_ID, TM, CD_NO)
	ORDER BY ROWNUM
	</select>
	
	<select id ="selectPassResultListStationB" parameterType="sVO" resultType="egovMap">
	SELECT ROWNUM, OPRAT_DATE, ANAL_AREA_CD, TFCMN, STTN_ID, STTN_NMA, STTN_HJD, CD_NO, STTN_BUS_GIN_AGG, STTN_BUS_GFF_AGG, STTN_BUS_TRS_AGG
	FROM
		(SELECT OPRAT_DATE, ANAL_AREA_CD, TFCMN, STTN_ID, STTN_NMA, STTN_HJD, CD_NO, STTN_BUS_GIN_AGG, STTN_BUS_GFF_AGG, STTN_BUS_TRS_AGG 
		FROM 결과지표_정류장별통행_일별
		WHERE 1=1
			AND SDATE = #{dateStart} 
			AND PROVIDER = #{provider}
			AND ANAL_AREA_CD = #{anal_area_cd}
			<if test="!cd_no[0].equals('00')">
				AND CD_NO IN
				<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
					#{arr}
				</foreach>
			</if>
			AND TFCMN ='B'
		ORDER BY OPRAT_DATE, STTN_ID, CD_NO)
	ORDER BY ROWNUM
	</select>
	
	<select id ="selectPassResultListStationT" parameterType="sVO" resultType="egovMap">
	SELECT ROWNUM, OPRAT_DATE, ANAL_AREA_CD, TFCMN, STTN_ID, STTN_NMA, STTN_HJD, CD_NO, STTN_TRAIN_GIN_AGG, STTN_TRAIN_GFF_AGG, STTN_TRAIN_TRS_AGG
	FROM
		(SELECT OPRAT_DATE, ANAL_AREA_CD, TFCMN, STTN_ID, STTN_NMA, STTN_HJD, CD_NO, STTN_TRAIN_GIN_AGG, STTN_TRAIN_GFF_AGG, STTN_TRAIN_TRS_AGG
		FROM 결과지표_정류장별통행_일별
		WHERE 1=1
			AND SDATE = #{dateStart}
			AND PROVIDER = #{provider}
			AND ANAL_AREA_CD = #{anal_area_cd}
			<if test="!cd_no[0].equals('00')">
				AND CD_NO IN
				<foreach collection="cd_no" item="arr" index="i" separator="," open="(" close=")">
					#{arr}
				</foreach>
			</if> 
			AND TFCMN ='T'
		ORDER BY OPRAT_DATE, STTN_ID, CD_NO)
	ORDER BY ROWNUM
	</select>
	
	<select id ="selectPassResultListAreaODPurpose" parameterType="sVO" resultType="egovMap">
		SELECT '행정동간OD목적' FROM DUAL
	</select>
	
	<select id ="selectPassResultListAreaODMethod" parameterType="sVO" resultType="egovMap">
		SELECT '행정동간OD수단' FROM DUAL
	</select>
	
	<select id ="selectPassResultListRouteOD" parameterType="sVO" resultType="egovMap">
		SELECT '노선별OD' FROM DUAL
	</select>
	
	<select id ="selectPassREsultListTopRoute" parameterType="sVO" resultType="egovMap">
		SELECT '상위이용노선' FROM DUAL
	</select>
	
	<select id ="selectPassResultListTopStation" parameterType="sVO" resultType="egovMap">
		SELECT '상위이용정류장' FROM DUAL	
	</select>
	
	
</mapper>